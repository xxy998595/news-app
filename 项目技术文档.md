# 移动端新闻资讯应用 - 项目技术文档

## 1. 项目概述
本项目是一个基于 Vue 3 和 Node.js 的全栈移动端新闻资讯应用。实现了用户注册登录、资讯浏览、发布编辑、图片上传、AI 话题推荐等功能。界面风格仿照今日头条/大众点评，适配移动端操作体验。

## 2. 技术栈

### 前端 (Client)
- **核心框架**: Vue 3 (Composition API)
- **构建工具**: Vite
- **UI 组件库**: Vant 4 (Mobile UI)
- **状态管理**: Pinia
- **路由管理**: Vue Router 4
- **HTTP 请求**: Axios
- **富文本编辑器**: @vueup/vue-quill

### 后端 (Server)
- **运行环境**: Node.js
- **Web 框架**: Express
- **数据库 ORM**: Sequelize
- **数据库**: MySQL
- **认证**: JWT (JSON Web Token)
- **AI 集成**: 火山引擎 (Volcengine Ark) / OpenAI Compatible API

### 部署 (Deployment)
- **前端托管**: Vercel
- **后端托管**: Railway
- **数据库托管**: Railway MySQL

## 3. 项目结构

```
project-root/
├── client/                 # 前端项目
│   ├── src/
│   │   ├── api/           # API 接口封装
│   │   ├── assets/        # 静态资源
│   │   ├── components/    # 公共组件 (ImageUploader, PostItem, TabBar)
│   │   ├── router/        # 路由配置
│   │   ├── stores/        # Pinia 状态管理
│   │   ├── views/         # 页面视图 (Home, Editor, PostDetail, Auth)
│   │   ├── App.vue        # 根组件
│   │   └── main.js        # 入口文件
│   └── vite.config.js     # Vite 配置
├── server/                 # 后端项目
│   ├── config/            # 配置文件 (数据库连接)
│   ├── controllers/       # 业务逻辑控制器
│   ├── middleware/        # 中间件 (Auth, Upload)
│   ├── models/            # Sequelize 数据模型
│   ├── routes/            # 路由定义
│   ├── uploads/           # 文件上传目录
│   └── app.js             # 后端入口
└── plan.md                 # 开发计划文档
```

## 4. 核心功能实现

### 4.1 用户认证
- 使用 `bcryptjs` 对用户密码进行加密存储。
- 登录成功后签发 JWT Token，前端存储在 Pinia 和 LocalStorage 中。
- Axios 拦截器自动在请求头中携带 `Authorization: Bearer <token>`。

### 4.2 资讯管理
- **发布/编辑**: 使用 Quill Editor 富文本编辑器，支持图文混排。
- **图片上传**: 使用 `multer` 中间件处理文件上传，支持单图和多图模式。
- **列表展示**: 首页支持下拉刷新和上拉加载更多（分页查询）。

### 4.3 AI 智能推荐
- 集成火山引擎 Ark API。
- 在用户查看文章详情时，后台异步分析文章内容，推荐相关话题标签。
- 点击推荐话题可直接跳转到编辑器并自动填充话题。

## 5. 数据库设计

### User 表
| 字段 | 类型 | 说明 |
| --- | --- | --- |
| id | INTEGER | 主键，自增 |
| username | STRING | 用户名，唯一 |
| password_hash | STRING | 加密后的密码 |

### Post 表
| 字段 | 类型 | 说明 |
| --- | --- | --- |
| id | INTEGER | 主键，自增 |
| title | STRING | 标题 |
| content | TEXT | 正文内容 (HTML) |
| images | JSON | 图片 URL 列表 |
| tags | JSON | 标签列表 |
| userId | INTEGER | 外键，关联 User |

## 6. 部署说明

### 环境变量配置

**前端 (.env.production)**
```
VITE_API_BASE_URL=https://your-backend-domain.app/api
```

**后端 (Railway Variables)**
```
PORT=3000
JWT_SECRET=your_secret
ARK_API_KEY=your_key
ARK_BASE_URL=https://ark.cn-beijing.volces.com/api/v3
DATABASE_URL=mysql://user:pass@host:port/dbname (Railway 自动注入)
```

### 部署流程
1. **后端**: 连接 GitHub 仓库到 Railway，设置 Root Directory 为 `/server`，配置环境变量。
2. **前端**: 连接 GitHub 仓库到 Vercel，设置 Root Directory 为 `/client`，配置 `VITE_API_BASE_URL`。
